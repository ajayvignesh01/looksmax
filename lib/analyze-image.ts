// utils/analyzeImage.ts
import OpenAI from "openai";
import openai from "./openai-client";

export const analyzeImage = async (imageUrl: string) => {
  const response = await openai.chat.completions.create({
    model: "gpt-4o",
    messages: [
      {
        role: "system",
        content: [
          {
            text: "You are an intelligent assistant who can accurately determine the attractiveness, canthal tilt, and eye type of a person.",
            type: "text",
          },
        ],
      },
      {
        role: "user",
        content: [
          {
            text: '{\n  "facial_features": [\n    {\n      "feature": "Canthal Tilt",\n      "types": [\n        {\n          "tilt": "Positive",\n          "description": "The outer corner of the eye is higher than the inner corner, creating a lifted and youthful appearance.",\n          "tips": [\n            "Accentuate the natural tilt with upward-sweeping eyeliner.",\n            "Use eyeshadow to enhance the lift, applying darker shades to the outer corners.",\n            "Highlight the inner corners and brow bone to draw attention upwards."\n          ]\n        },\n        {\n          "tilt": "Neutral",\n          "description": "The outer and inner corners of the eye are at the same level, creating a balanced appearance.",\n          "tips": [\n            "Maintain a balanced look with even application of eyeliner along the lash line.",\n            "Use a gradient of eyeshadow to add depth without altering the natural tilt.",\n            "Highlight the brow bone and inner corners to add brightness without emphasizing the tilt."\n          ]\n        },\n        {\n          "tilt": "Negative",\n          "description": "The inner corner of the eye is higher than the outer corner, creating a downturned and often melancholic appearance.",\n          "tips": [\n            "Use eyeliner that extends upward at the outer corners to create a lifting effect.",\n            "Avoid heavy eyeliner on the lower lid to prevent enhancing the downturned look.",\n            "Apply mascara to the upper lashes, focusing on the outer corners to create an uplifted effect."\n          ]\n        }\n      ]\n    },\n    {\n      "feature": "Eye Type",\n      "types": [\n        {\n          "type": "Hunter Eyes",\n          "description": "Deep-set eyes with a slightly downward slant, creating an intense and predatory look.",\n          "characteristics": ["Prominent brow ridge", "Lower-set brows", "Sharper, more angular eye shape"],\n          "canthal_tilt": "Positive",\n          "tips_men": [\n            "Groom and shape your brows to enhance their prominence.",\n            "Use a matte eyeshadow in a neutral tone to create depth and shadow.",\n            "Consider a subtle smoky eye look for special occasions to add intensity."\n          ],\n          "tips_women": [\n            "Shape and define your brows to emphasize their prominence.",\n            "Apply matte eyeshadows in neutral tones to create depth and shadow.",\n            "Use a smoky eye makeup technique to add intensity and focus to your eyes."\n          ],\n          "attractiveness_rating": 9\n        },\n        {\n          "type": "Prey Eyes",\n          "description": "Large, round eyes with a gentle and approachable look.",\n          "characteristics": ["Larger eyes", "More open and round appearance", "Higher brow position"],\n          "canthal_tilt": "Negative or Neutral",\n          "tips_men": [\n            "Keep your brows well-groomed to complement your eye shape.",\n            "Use a light touch of eyeliner to subtly define your eyes.",\n            "Consider a clear or brown mascara to emphasize your lashes without being too noticeable."\n          ],\n          "tips_women": [\n            "Use eyeliner to outline your eyes and enhance their round shape.",\n            "Apply mascara generously to both upper and lower lashes to emphasize the size and openness of your eyes.",\n            "Consider using light, shimmery eyeshadows on the lids and inner corners to make your eyes appear even larger and more inviting."\n          ],\n          "attractiveness_rating": 8\n        }\n      ]\n    },\n    {\n      "feature": "Eye Shape",\n      "types": [\n        {\n          "type": "Round Eyes",\n          "description": "Eyes with a circular shape, often giving a more youthful and expressive appearance.",\n          "characteristics": ["Wide-open appearance", "Whites of the eyes visible around the iris"],\n          "canthal_tilt": "Neutral (but can be Positive or Negative)",\n          "tips_men": [\n            "Use a subtle eyeliner to enhance the roundness of your eyes.",\n            "Apply a highlighting shade on the brow bone to accentuate the openness of your eyes.",\n            "Consider using a clear mascara to create long, natural-looking lashes."\n          ],\n          "tips_women": [\n            "Use eyeliner to enhance the roundness; a simple line along the upper lash line can make your eyes pop.",\n            "Apply a highlighting shade on the brow bone and inner corners to accentuate the openness of your eyes.",\n            "Use mascara to create long, voluminous lashes, focusing on the center of your lashes to further emphasize the round shape."\n          ],\n          "attractiveness_rating": 7\n        },\n        {\n          "type": "Almond Eyes",\n          "description": "Eyes shaped like an almond, with a slightly upswept outer corner, giving a balanced and exotic look.",\n          "characteristics": ["Symmetrical shape", "Outer corners slightly higher than inner corners"],\n          "canthal_tilt": "Positive",\n          "tips_men": [\n            "Enhance the natural shape with a subtle eyeliner that follows the contour of your eyes.",\n            "Use a gradient of neutral eyeshadows to add depth, starting with lighter shades on the inner corners.",\n            "Keep brows well-groomed to frame your eyes effectively."\n          ],\n          "tips_women": [\n            "Enhance the natural shape with eyeliner that follows the contour of your eyes, slightly extending past the outer corners.",\n            "Use eyeshadows in gradients to add depth, starting with lighter shades on the inner corners and gradually using darker shades towards the outer corners.",\n            "Try tightlining your upper waterline to make your eyes appear more defined and naturally enhanced."\n          ],\n          "attractiveness_rating": 10\n        },\n        {\n          "type": "Hooded Eyes",\n          "description": "Eyes with a fold of skin that droops over the crease, making the lid appear smaller.",\n          "characteristics": ["Upper eyelid partially covers the eye"],\n          "canthal_tilt": "Neutral",\n          "tips_men": [\n            "Use a light, neutral eyeshadow on the lid to brighten the eye area.",\n            "Keep eyeliner thin and close to the lash line to avoid making the lids appear heavier.",\n            "Consider using a lash curler to open up your eyes."\n          ],\n          "tips_women": [\n            "Use eyeshadow techniques to lift the appearance of your eyes, such as applying darker shades in the crease and lighter shades on the lid.",\n            "Focus on keeping your eyeliner thin and close to the lash line to avoid making the lids appear heavier.",\n            "Curl your lashes and apply mascara to open up your eyes and create a lifted effect."\n          ],\n          "attractiveness_rating": 6\n        },\n        {\n          "type": "Monolid Eyes",\n          "description": "Eyes lacking a visible crease in the eyelid, resulting in a smooth, flat appearance.",\n          "characteristics": ["Smooth eyelid surface without a defined crease"],\n          "canthal_tilt": "Neutral (but can be Positive or Negative)",\n          "tips_men": [\n            "Use a subtle eyeliner to define the lash line.",\n            "Apply eyeshadow in gradient shades to add dimension and depth.",\n            "Focus on creating a seamless blend of colors to enhance the natural beauty of your eyes."\n          ],\n          "tips_women": [\n            "Use eyeliner to create a faux crease or to define the lash line.",\n            "Apply eyeshadow in gradient shades to add dimension and depth.",\n            "Focus on creating a seamless blend of colors to enhance the natural beauty of your eyes."\n          ],\n          "attractiveness_rating": 7\n        }\n      ]\n    },\n    {\n      "feature": "Jawline",\n      "types": [\n        {\n          "type": "Strong Jawline",\n          "description": "A well-defined jawline with sharp angles, often associated with attractiveness and masculinity.",\n          "characteristics": ["Prominent and angular jaw", "Clear distinction between the jaw and neck"],\n          "tips": [\n            "Maintain a healthy diet and exercise to reduce fat around the jaw area.",\n            "Consider facial exercises to strengthen the jaw muscles.",\n            "Use contouring makeup techniques to enhance the definition."\n          ]\n        },\n        {\n          "type": "Soft Jawline",\n          "description": "A less defined jawline with softer angles, often giving a more youthful or feminine appearance.",\n          "characteristics": ["Rounder and less angular jaw", "Less distinction between the jaw and neck"],\n          "tips": [\n            "Use contouring makeup techniques to create the illusion of a more defined jawline.",\n            "Maintain good posture to elongate the neck and improve the appearance of the jawline.",\n            "Consider facial exercises to tone the jaw muscles."\n          ]\n        }\n      ]\n    },\n    {\n      "feature": "Cheekbones",\n      "types": [\n        {\n          "type": "High Cheekbones",\n          "description": "Cheekbones that are prominent and positioned high on the face, often associated with attractiveness.",\n          "characteristics": ["Prominent and elevated cheekbones", "Well-defined facial structure"],\n          "tips": [\n            "Use highlighter on the tops of the cheekbones to enhance their prominence.",\n            "Apply blush slightly above the apples of your cheeks to accentuate the height.",\n            "Maintain a healthy diet and exercise to reduce facial fat and highlight the cheekbones."\n          ]\n        },\n        {\n          "type": "Low Cheekbones",\n          "description": "Cheekbones that are positioned lower on the face, often giving a softer and rounder facial appearance.",\n          "characteristics": ["Less prominent and lower-set cheekbones", "Rounder facial structure"],\n          "tips": [\n            "Use contouring makeup to create the illusion of higher cheekbones.",\n            "Apply blush on the apples of your cheeks to add dimension.",\n            "Maintain a healthy skincare routine to keep the skin firm and tight around the cheeks."\n          ]\n        }\n      ]\n    },\n    {\n      "feature": "Masculinity/Femininity",\n      "types": [\n        {\n          "type": "Masculine Features",\n          "description": "Facial features that are traditionally associated with male aesthetics, such as a strong jawline and prominent brow ridge.",\n          "characteristics": ["Strong jawline", "Prominent brow ridge", "Broader forehead"],\n          "tips": [\n            "Maintain a healthy diet and exercise to enhance muscle definition.",\n            "Use skincare products to keep the skin clear and smooth.",\n            "Consider grooming techniques to highlight masculine features, such as beard shaping."\n          ]\n        },\n        {\n          "type": "Feminine Features",\n          "description": "Facial features that are traditionally associated with female aesthetics, such as high cheekbones and a softer jawline.",\n          "characteristics": ["High cheekbones", "Softer jawline", "Fuller lips"],\n          "tips": [\n            "Use makeup techniques to enhance feminine features, such as highlighting and contouring.",\n            "Maintain a healthy skincare routine to keep the skin soft and smooth.",\n            "Consider hair styles that frame the face and highlight feminine features."\n          ]\n        }\n      ]\n    },\n    {\n      "feature": "Skin Quality",\n      "types": [\n        {\n          "type": "Clear Skin",\n          "description": "Skin that is free from blemishes, acne, and other imperfections, often associated with good health and youthfulness.",\n          "characteristics": ["Smooth texture", "Even skin tone", "No visible blemishes"],\n          "tips": [\n            "Follow a consistent skincare routine with cleansing, moisturizing, and sun protection.",\n            "Eat a balanced diet rich in vitamins and antioxidants.",\n            "Stay hydrated and get enough sleep to maintain healthy skin."\n          ]\n        },\n        {\n          "type": "Problematic Skin",\n          "description": "Skin that has visible imperfections such as acne, scars, or uneven texture.",\n          "characteristics": ["Visible blemishes", "Uneven texture", "Acne or scars"],\n          "tips": [\n            "Use skincare products specifically designed for your skin type.",\n            "Consult a dermatologist for personalized skincare advice.",\n            "Avoid touching your face and maintain a healthy diet to reduce breakouts."\n          ]\n        }\n      ]\n    },\n    {\n      "feature": "Potential",\n      "types": [\n        {\n          "type": "High Potential",\n          "description": "Facial features that can be easily enhanced with grooming, skincare, and styling techniques.",\n          "characteristics": ["Symmetrical features", "Balanced proportions", "Good skin quality"],\n          "tips": [\n            "Invest in a good skincare routine to maintain and enhance your features.",\n            "Experiment with different hairstyles and grooming techniques to find what suits you best.",\n            "Consider professional grooming services, such as facials and haircuts, to maximize your potential."\n          ]\n        },\n        {\n          "type": "Low Potential",\n          "description": "Facial features that might require more effort to enhance due to asymmetry, skin issues, or other factors.",\n          "characteristics": ["Asymmetrical features", "Visible skin issues", "Unbalanced proportions"],\n          "tips": [\n            "Focus on skincare and grooming to improve the appearance of your features.",\n            "Consider professional advice from dermatologists or stylists.",\n            "Stay positive and focus on enhancing the features you are happy with."\n          ]\n        }\n      ]\n    },\n    {\n      "feature": "Face Shape",\n      "types": [\n        {\n          "type": "Rectangle Face",\n          "description": "A face shape characterized by a longer face with straight cheek lines and a defined jawline.",\n          "characteristics": ["Longer face", "Straight cheek lines", "Defined jawline"],\n          "tips": [\n            "Use hairstyles that add width to the sides of your face, such as layered cuts.",\n            "Apply contouring makeup to soften the angles of your face.",\n            "Use accessories like earrings and necklaces to draw attention to the width of your face."\n          ]\n        },\n        {\n          "type": "Oval Face",\n          "description": "A face shape that is longer than it is wide, with a rounded jaw and forehead.",\n          "characteristics": ["Longer than wide", "Rounded jaw", "Rounded forehead"],\n          "tips": [\n            "Experiment with different hairstyles, as most styles suit this versatile face shape.",\n            "Highlight your cheekbones with blush to enhance the natural balance of your face.",\n            "Avoid heavy bangs that can shorten the appearance of your face."\n          ]\n        },\n        {\n          "type": "Round Face",\n          "description": "A face shape characterized by wide cheekbones and a rounded jawline.",\n          "characteristics": ["Wide cheekbones", "Rounded jawline"],\n          "tips": [\n            "Use hairstyles that add height and length to the face, such as layered cuts and volume on top.",\n            "Apply contouring makeup to add definition and create the illusion of angles.",\n            "Avoid round or wide accessories that can emphasize the roundness of your face."\n          ]\n        },\n        {\n          "type": "Square Face",\n          "description": "A face shape with a broad forehead, wide cheekbones, and a strong jawline.",\n          "characteristics": ["Broad forehead", "Wide cheekbones", "Strong jawline"],\n          "tips": [\n            "Use hairstyles that soften the angles of your face, such as soft waves or curls.",\n            "Apply contouring makeup to reduce the prominence of the jawline and add softness.",\n            "Choose accessories that add length to the face, such as long earrings."\n          ]\n        }\n      ]\n    }\n  ]\n}\n\nNow, do you understand the above information and have the ability to use it to accurately access a person\'s features?',
            type: "text",
          },
        ],
      },
      {
        role: "assistant",
        content: [
          {
            text: "Yes. I do. I have my own understanding of Looksmaxing, but I will use the above information to aid me with any tasks you assign.",
            type: "text",
          },
        ],
      },
      {
        role: "user",
        content: [
          {
            text: "Give me the response in JSON format. Give percentages if there are multiple options. Add reasoning for each data point. All percentages should add up to 100.\n\nBelow is an OpenAPI specification for the response I want you to provide\n\nopenapi: 3.0.0\n\ninfo:\n  title: Eye Analysis API\n  version: 1.0.0\n  description: This API provides an analysis of eye characteristics, including canthal tilt and eye type, based on an image.\n\npaths:\n  /analyze-eyes:\n    post:\n      summary: Analyze eye characteristics\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              type: object\n              properties:\n                image:\n                  type: string\n                  format: binary\n                  description: Image file containing a clear view of the person's eyes for analysis.\n                  required: true\n      responses:\n        '200':\n          description: Successful eye analysis\n          content:\n            application/json:\n              schema:\n                type: object\n                required:\n                  - canthal_tilt\n                  - eye_type\n                  - eye_shape\n                  - face_shape\n                  - jawline\n                  - cheekbones\n                  - masculinity_femininity\n                  - skin_quality\n                  - hair_attractiveness\n                  - potential\n                properties:\n                  canthal_tilt:\n                    type: object\n                    description: Details of the canthal tilt with confidence and reasoning.\n                    required:\n                      - type\n                      - confidence\n                      - reasoning\n                      - thought_process\n                      - characteristics_identified\n                      - attractiveness_score\n                      - score_explanation\n                    properties:\n                      type:\n                        type: string\n                        description: Type of canthal tilt (Neutral, Negative, Positive)\n                      confidence:\n                        type: number\n                        format: float\n                        description: Confidence level of the canthal tilt analysis.\n                      reasoning:\n                        type: string\n                        description: Reasoning behind the canthal tilt determination.\n                      thought_process:\n                        type: string\n                        description: Step-by-step reasoning leading to the score determination.\n                      characteristics_identified:\n                        type: array\n                        items:\n                          type: string\n                        description: Key characteristics of the canthal tilt.\n                      attractiveness_score:\n                        type: number\n                        format: integer\n                        description: |\n                          Attractiveness score of the canthal tilt, from 0 to 100 (percentile). This score is based on both the characteristics identified and the AI's understanding of attractiveness.\n                          Criteria:\n                          - 95-100: Ideal positive canthal tilt, indicating a youthful and attractive eye shape. Examples: Angelina Jolie, Chris Hemsworth.\n                          - 85-94: Near-ideal positive canthal tilt. Examples: Natalie Portman, Henry Cavill.\n                          - 75-84: Very attractive positive canthal tilt. Examples: Emma Stone, Ryan Reynolds.\n                          - 65-74: Attractive positive canthal tilt with minor imperfections. Examples: Anne Hathaway, Zac Efron.\n                          - 55-64: Slightly above average positive canthal tilt. Examples: Jennifer Lawrence, Brad Pitt.\n                          - 45-54: Average positive or neutral canthal tilt. Examples: Emily Blunt, John Krasinski.\n                          - 35-44: Slightly below average canthal tilt. Examples: Zooey Deschanel, Jake Gyllenhaal.\n                          - 25-34: Below average canthal tilt, potentially negative. Examples: Kirsten Dunst, Shia LaBeouf.\n                          - 15-24: Noticeably below average canthal tilt, often negative. Examples: Tilda Swinton, Steve Buscemi.\n                          - 5-14: Significantly below average canthal tilt. Examples: Lily Cole, Adrien Brody.\n                          - 0-4: Pronounced negative canthal tilt, often considered less attractive due to the downturned appearance.\n                      score_explanation:\n                        type: string\n                        description: Explanation of why the specific score was given based on the analysis.\n\n                  eye_type:\n                    type: object\n                    description: Detailed analysis of the eye type.\n                    required:\n                      - type\n                      - thought_process\n                      - characteristics_identified\n                      - attractiveness_score\n                      - score_explanation\n                    properties:\n                      type:\n                        type: string\n                        description: Type of eye (e.g., Hunter Eyes, Prey Eyes)\n                      thought_process:\n                        type: string\n                        description: Step-by-step reasoning leading to the score determination.\n                      characteristics_identified:\n                        type: array\n                        items:\n                          type: string\n                        description: Key characteristics of the eye type.\n                      attractiveness_score:\n                        type: number\n                        format: integer\n                        description: |\n                          Attractiveness score of the eye type, from 0 to 100 (percentile). This score is based on both the characteristics identified and the AI's understanding of attractiveness.\n                          Criteria:\n                          - 95-100: Highly attractive eye types such as hunter eyes, characterized by deep-set, intense, and symmetrical appearance. Examples: Megan Fox, David Beckham.\n                          - 85-94: Near-ideal eye types. Examples: Mila Kunis, Ian Somerhalder.\n                          - 75-84: Very attractive eye types. Examples: Scarlett Johansson, Tom Hardy.\n                          - 65-74: Attractive eye types with minor imperfections. Examples: Keira Knightley, Channing Tatum.\n                          - 55-64: Slightly above average eye types. Examples: Emilia Clarke, Chris Evans.\n                          - 45-54: Average eye types that are generally considered attractive. Examples: Kristen Bell, Joseph Gordon-Levitt.\n                          - 35-44: Slightly below average eye types. Examples: Amanda Seyfried, Elijah Wood.\n                          - 25-34: Below average eye types. Examples: Kate Winslet, Daniel Radcliffe.\n                          - 15-24: Noticeably below average eye types. Examples: Rooney Mara, Jesse Eisenberg.\n                          - 5-14: Significantly below average eye types. Examples: Anna Kendrick, Michael Cera.\n                          - 0-4: Eye types that are often considered less attractive due to significant asymmetry or other factors.\n                      score_explanation:\n                        type: string\n                        description: Explanation of why the specific score was given based on the analysis.\n\n                  eye_shape:\n                    type: object\n                    description: Detailed analysis of the eye shape.\n                    required:\n                      - type\n                      - thought_process\n                      - characteristics_identified\n                      - canthal_tilt\n                      - attractiveness_score\n                      - score_explanation\n                    properties:\n                      type:\n                        type: string\n                        description: Shape of the eyes (e.g., Round Eyes, Almond Eyes)\n                      thought_process:\n                        type: string\n                        description: Step-by-step reasoning leading to the score determination.\n                      characteristics_identified:\n                        type: array\n                        items:\n                          type: string\n                        description: Key characteristics of the eye shape.\n                      canthal_tilt:\n                        type: string\n                        description: Typical canthal tilt associated with this eye shape.\n                      attractiveness_score:\n                        type: number\n                        format: integer\n                        description: |\n                          Attractiveness score of the eye shape, from 0 to 100 (percentile). This score is based on both the characteristics identified and the AI's understanding of attractiveness.\n                          Criteria:\n                          - 95-100: Ideal eye shapes such as almond eyes, often associated with beauty and attractiveness. Examples: Taylor Swift, Johnny Depp.\n                          - 85-94: Near-ideal eye shapes. Examples: Zooey Deschanel, Jude Law.\n                          - 75-84: Very attractive eye shapes. Examples: Mila Kunis, Jake Gyllenhaal.\n                          - 65-74: Attractive eye shapes with minor imperfections. Examples: Emma Watson, Chris Pine.\n                          - 55-64: Slightly above average eye shapes. Examples: Emma Roberts, Matt Damon.\n                          - 45-54: Average eye shapes that are generally considered attractive. Examples: Jennifer Aniston, Leonardo DiCaprio.\n                          - 35-44: Slightly below average eye shapes. Examples: Reese Witherspoon, Tobey Maguire.\n                          - 25-34: Below average eye shapes. Examples: Sarah Jessica Parker, Elijah Wood.\n                          - 15-24: Noticeably below average eye shapes. Examples: Elle Fanning, Macaulay Culkin.\n                          - 5-14: Significantly below average eye shapes. Examples: Gwendoline Christie, Willem Dafoe.\n                          - 0-4: Eye shapes that are often considered less attractive due to significant deviations from the norm.\n                      score_explanation:\n                        type: string\n                        description: Explanation of why the specific score was given based on the analysis.\n\n                  face_shape:\n                    type: object\n                    description: Detailed analysis of the face shape.\n                    required:\n                      - type\n                      - thought_process\n                      - characteristics_identified\n                      - attractiveness_score\n                      - score_explanation\n                    properties:\n                      type:\n                        type: string\n                        description: Shape of the face (e.g., Rectangle Face, Oval Face)\n                      thought_process:\n                        type: string\n                        description: Step-by-step reasoning leading to the score determination.\n                      characteristics_identified:\n                        type: array\n                        items:\n                          type: string\n                        description: Key characteristics of the face shape.\n                      attractiveness_score:\n                        type: number\n                        format: integer\n                        description: |\n                          Attractiveness score of the face shape, from 0 to 100 (percentile). This score is based on both the characteristics identified and the AI's understanding of attractiveness.\n                          Criteria:\n                          - 95-100: Ideal face shapes such as oval, often considered the most versatile and attractive. Examples: Beyoncé, Brad Pitt.\n                          - 85-94: Near-ideal face shapes. Examples: Olivia Wilde, Ryan Gosling.\n                          - 75-84: Very attractive face shapes. Examples: Natalie Portman, Robert Pattinson.\n                          - 65-74: Attractive face shapes with minor imperfections. Examples: Kate Hudson, Zac Efron.\n                          - 55-64: Slightly above average face shapes. Examples: Selena Gomez, Chris Pratt.\n                          - 45-54: Average face shapes that are generally considered attractive. Examples: Jennifer Lawrence, Chris Hemsworth.\n                          - 35-44: Slightly below average face shapes. Examples: Amanda Seyfried, Shia LaBeouf.\n                          - 25-34: Below average face shapes. Examples: Sarah Jessica Parker, Daniel Radcliffe.\n                          - 15-24: Noticeably below average face shapes. Examples: Rooney Mara, Steve Buscemi.\n                          - 5-14: Significantly below average face shapes. Examples: Lily Cole, Adrien Brody.\n                          - 0-4: Face shapes that are often considered less attractive due to significant asymmetry or other factors.\n                      score_explanation:\n                        type: string\n                        description: Explanation of why the specific score was given based on the analysis.\n\n                  jawline:\n                    type: object\n                    description: Detailed analysis of the jawline.\n                    required:\n                      - type\n                      - thought_process\n                      - characteristics_identified\n                      - attractiveness_score\n                      - score_explanation\n                    properties:\n                      type:\n                        type: string\n                        description: Type of jawline (e.g., Strong Jawline, Soft Jawline)\n                      thought_process:\n                        type: string\n                        description: Step-by-step reasoning leading to the score determination.\n                      characteristics_identified:\n                        type: array\n                        items:\n                          type: string\n                        description: Key characteristics of the jawline type.\n                      attractiveness_score:\n                        type: number\n                        format: integer\n                        description: |\n                          Attractiveness score of the jawline, from 0 to 100 (percentile). This score is based on both the characteristics identified and the AI's understanding of attractiveness.\n                          Criteria:\n                          - 95-100: Strong, well-defined jawlines often associated with attractiveness and masculinity. Examples: Angelina Jolie, Henry Cavill.\n                          - 85-94: Near-ideal jawlines. Examples: Keira Knightley, David Gandy.\n                          - 75-84: Very attractive jawlines. Examples: Charlize Theron, Chris Hemsworth.\n                          - 65-74: Attractive jawlines with minor imperfections. Examples: Jennifer Garner, Jake Gyllenhaal.\n                          - 55-64: Slightly above average jawlines. Examples: Olivia Munn, Ryan Reynolds.\n                          - 45-54: Average jawlines that are neither strongly defined nor too soft. Examples: Emma Stone, John Krasinski.\n                          - 35-44: Slightly below average jawlines. Examples: Jessica Biel, Tobey Maguire.\n                          - 25-34: Below average jawlines. Examples: Kirsten Dunst, Elijah Wood.\n                          - 15-24: Noticeably below average jawlines. Examples: Rooney Mara, Jesse Eisenberg.\n                          - 5-14: Significantly below average jawlines. Examples: Lily Cole, Michael Cera.\n                          - 0-4: Jawlines that are often considered less attractive due to significant deviations from the norm.\n                      score_explanation:\n                        type: string\n                        description: Explanation of why the specific score was given based on the analysis.\n\n                  cheekbones:\n                    type: object\n                    description: Detailed analysis of the cheekbones.\n                    required:\n                      - type\n                      - thought_process\n                      - characteristics_identified\n                      - attractiveness_score\n                      - score_explanation\n                    properties:\n                      type:\n                        type: string\n                        description: Type of cheekbones (e.g., High Cheekbones, Low Cheekbones)\n                      thought_process:\n                        type: string\n                        description: Step-by-step reasoning leading to the score determination.\n                      characteristics_identified:\n                        type: array\n                        items:\n                          type: string\n                        description: Key characteristics of the cheekbone type.\n                      attractiveness_score:\n                        type: number\n                        format: integer\n                        description: |\n                          Attractiveness score of the cheekbones, from 0 to 100 (percentile). This score is based on both the characteristics identified and the AI's understanding of attractiveness.\n                          Criteria:\n                          - 95-100: High, prominent cheekbones often associated with beauty and attractiveness. Examples: Angelina Jolie, Johnny Depp.\n                          - 85-94: Near-ideal cheekbones. Examples: Natalie Portman, David Beckham.\n                          - 75-84: Very attractive cheekbones. Examples: Scarlett Johansson, Tom Hardy.\n                          - 65-74: Attractive cheekbones with minor imperfections. Examples: Keira Knightley, Channing Tatum.\n                          - 55-64: Slightly above average cheekbones. Examples: Emilia Clarke, Chris Evans.\n                          - 45-54: Average cheekbones that are generally considered attractive. Examples: Jennifer Aniston, Leonardo DiCaprio.\n                          - 35-44: Slightly below average cheekbones. Examples: Reese Witherspoon, Tobey Maguire.\n                          - 25-34: Below average cheekbones. Examples: Kate Winslet, Elijah Wood.\n                          - 15-24: Noticeably below average cheekbones. Examples: Elle Fanning, Jesse Eisenberg.\n                          - 5-14: Significantly below average cheekbones. Examples: Gwendoline Christie, Willem Dafoe.\n                          - 0-4: Cheekbones that are often considered less attractive due to significant deviations from the norm.\n                      score_explanation:\n                        type: string\n                        description: Explanation of why the specific score was given based on the analysis.\n\n                  masculinity_femininity:\n                    type: object\n                    description: Detailed analysis of masculinity or femininity.\n                    required:\n                      - type\n                      - thought_process\n                      - characteristics_identified\n                      - attractiveness_score\n                      - score_explanation\n                    properties:\n                      type:\n                        type: string\n                        description: Type (e.g., Masculine Features, Feminine Features)\n                      thought_process:\n                        type: string\n                        description: Step-by-step reasoning leading to the score determination.\n                      characteristics_identified:\n                        type: array\n                        items:\n                          type: string\n                        description: Key characteristics of masculinity or femininity.\n                      attractiveness_score:\n                        type: number\n                        format: integer\n                        description: |\n                          Attractiveness score of masculinity or femininity, from 0 to 100 (percentile). This score is based on both the characteristics identified and the AI's understanding of attractiveness.\n                          Criteria:\n                          - 95-100: Strongly masculine or feminine features often associated with attractiveness. Examples: Angelina Jolie, Brad Pitt.\n                          - 85-94: Near-ideal masculine or feminine features. Examples: Mila Kunis, Ryan Gosling.\n                          - 75-84: Very attractive masculine or feminine features. Examples: Scarlett Johansson, Chris Hemsworth.\n                          - 65-74: Attractive masculine or feminine features with minor imperfections. Examples: Emma Stone, Channing Tatum.\n                          - 55-64: Slightly above average masculine or feminine features. Examples: Jennifer Lawrence, Chris Evans.\n                          - 45-54: Average masculine or feminine features that are generally considered attractive. Examples: Kristen Bell, Joseph Gordon-Levitt.\n                          - 35-44: Slightly below average masculine or feminine features. Examples: Amanda Seyfried, Elijah Wood.\n                          - 25-34: Below average masculine or feminine features. Examples: Kate Winslet, Daniel Radcliffe.\n                          - 15-24: Noticeably below average masculine or feminine features. Examples: Rooney Mara, Jesse Eisenberg.\n                          - 5-14: Significantly below average masculine or feminine features. Examples: Anna Kendrick, Michael Cera.\n                          - 0-4: Features that are often considered less attractive due to significant deviations from the norm.\n                      score_explanation:\n                        type: string\n                        description: Explanation of why the specific score was given based on the analysis.\n\n                  skin_quality:\n                    type: object\n                    description: Detailed analysis of skin quality.\n                    required:\n                      - type\n                      - thought_process\n                      - characteristics_identified\n                      - attractiveness_score\n                      - score_explanation\n                    properties:\n                      type:\n                        type: string\n                        description: Type of skin quality (e.g., Clear Skin, Problematic Skin)\n                      thought_process:\n                        type: string\n                        description: Step-by-step reasoning leading to the score determination.\n                      characteristics_identified:\n                        type: array\n                        items:\n                          type: string\n                        description: Key characteristics of the skin quality.\n                      attractiveness_score:\n                        type: number\n                        format: integer\n                        description: |\n                          Attractiveness score of the skin quality, from 0 to 100 (percentile). This score is based on both the characteristics identified and the AI's understanding of attractiveness.\n                          Criteria:\n                          - 95-100: Clear, healthy skin free from blemishes and imperfections. Examples: Emma Watson, Chris Hemsworth.\n                          - 85-94: Mostly clear skin with minor imperfections. Examples: Jennifer Aniston, Ryan Reynolds.\n                          - 75-84: Very attractive skin with few imperfections. Examples: Natalie Portman, Zac Efron.\n                          - 65-74: Attractive skin with some minor imperfections. Examples: Keira Knightley, Channing Tatum.\n                          - 55-64: Slightly above average skin. Examples: Emma Stone, Chris Evans.\n                          - 45-54: Average skin quality with some blemishes or uneven texture. Examples: Jennifer Lawrence, Chris Pratt.\n                          - 35-44: Slightly below average skin quality. Examples: Amanda Seyfried, Shia LaBeouf.\n                          - 25-34: Below average skin quality. Examples: Kate Winslet, Elijah Wood.\n                          - 15-24: Noticeably below average skin quality. Examples: Rooney Mara, Jesse Eisenberg.\n                          - 5-14: Significantly below average skin quality. Examples: Anna Kendrick, Michael Cera.\n                          - 0-4: Significant skin issues affecting overall attractiveness. Examples: Lily Cole, Adrien Brody.\n                      score_explanation:\n                        type: string\n                        description: Explanation of why the specific score was given based on the analysis.\n\n                  hair_attractiveness:\n                    type: object\n                    description: Detailed analysis of hair attractiveness.\n                    required:\n                      - type\n                      - thought_process\n                      - characteristics_identified\n                      - attractiveness_score\n                      - score_explanation\n                    properties:\n                      type:\n                        type: string\n                        description: Type of hair attractiveness (e.g., Thick and Lush, Thinning)\n                      thought_process:\n                        type: string\n                        description: Step-by-step reasoning leading to the score determination.\n                      characteristics_identified:\n                        type: array\n                        items:\n                          type: string\n                        description: Key characteristics of the hair.\n                      attractiveness_score:\n                        type: number\n                        format: integer\n                        description: |\n                          Attractiveness score of the hair, from 0 to 100 (percentile). This score is based on both the characteristics identified and the AI's understanding of attractiveness.\n                          Criteria:\n                          - 95-100: Ideal hair quality, thick and lush. Examples: Blake Lively, Jason Momoa.\n                          - 85-94: Near-ideal hair quality. Examples: Mila Kunis, Henry Cavill.\n                          - 75-84: Very attractive hair quality. Examples: Scarlett Johansson, Chris Hemsworth.\n                          - 65-74: Attractive hair quality with minor imperfections. Examples: Emma Stone, Zac Efron.\n                          - 55-64: Slightly above average hair quality. Examples: Jennifer Lawrence, Chris Evans.\n                          - 45-54: Average hair quality that is generally considered attractive. Examples: Kristen Bell, Joseph Gordon-Levitt.\n                          - 35-44: Slightly below average hair quality. Examples: Amanda Seyfried, Elijah Wood.\n                          - 25-34: Below average hair quality. Examples: Kate Winslet, Daniel Radcliffe.\n                          - 15-24: Noticeably below average hair quality. Examples: Rooney Mara, Jesse Eisenberg.\n                          - 5-14: Significantly below average hair quality. Examples: Anna Kendrick, Michael Cera.\n                          - 0-4: Hair quality that is often considered less attractive due to significant thinning or other issues. Examples: Lily Cole, Adrien Brody.\n                      score_explanation:\n                        type: string\n                        description: Explanation of why the specific score was given based on the analysis.\n\n                  potential:\n                    type: object\n                    description: Analysis of enhancement potential.\n                    required:\n                      - type\n                      - thought_process\n                      - characteristics_identified\n                      - attractiveness_score\n                      - explanation\n                    properties:\n                      type:\n                        type: string\n                        description: Potential level (e.g., High Potential, Low Potential)\n                      thought_process:\n                        type: string\n                        description: Step-by-step reasoning leading to the score determination.\n                      characteristics_identified:\n                        type: array\n                        items:\n                          type: string\n                        description: Key characteristics of the potential level.\n                      attractiveness_score:\n                        type: number\n                        format: integer\n                        description: |\n                          Attractiveness score of the potential, from 0 to 100 (percentile). This score is based on both the characteristics identified and the AI's understanding of attractiveness.\n                          Explanation: The potential score indicates the maximum attractiveness score a person can achieve based on their current features and the potential for improvement. It takes into account the areas where improvements can be made and the effort required to achieve those improvements.\n                          Criteria:\n                          - 95-100: High potential for enhancement with minimal effort. Examples: Angelina Jolie, Brad Pitt.\n                          - 85-94: Good potential for enhancement. Examples: Natalie Portman, Ryan Gosling.\n                          - 75-84: Above average potential for enhancement. Examples: Scarlett Johansson, Chris Hemsworth.\n                          - 65-74: Moderate potential for enhancement. Examples: Emma Stone, Channing Tatum.\n                          - 55-64: Slightly above average potential. Examples: Jennifer Lawrence, Chris Evans.\n                          - 45-54: Average potential for enhancement. Examples: Kristen Bell, Joseph Gordon-Levitt.\n                          - 35-44: Slightly below average potential. Examples: Amanda Seyfried, Elijah Wood.\n                          - 25-34: Below average potential. Examples: Kate Winslet, Daniel Radcliffe.\n                          - 15-24: Noticeably below average potential. Examples: Rooney Mara, Jesse Eisenberg.\n                          - 5-14: Significantly below average potential. Examples: Anna Kendrick, Michael Cera.\n                          - 0-4: Very low potential for enhancement, features difficult to improve significantly. Examples: Lily Cole, Adrien Brody.\n                      explanation:\n                        type: string\n                        description: Explanation of the potential score, including the main area of improvement and why the score is higher than the current attractiveness score.\n\n\n\nReturn only JSON and nothing else. Do not start with ```json, but just return the json. Note that this response will be directly processed as json. Make sure to include all fields. Be honest and accurate in your scores, do not make the scores too high.\n\nHere is the person you are assessing:",
            type: "text",
          },
        ],
      },
      {
        role: "assistant",
        content: [
          {
            type: "text",
            text: '{\n  "canthal_tilt": {\n    "type": "Neutral",\n    "confidence": 80.0,\n    "reasoning": "The outer and inner corners of the eyes appear to be at nearly the same level.",\n    "thought_process": "The analysis focused on comparing the height of the outer corners of the eyes to the inner corners, noting minimal difference.",\n    "characteristics_identified": [\n      "Balanced eye corners",\n      "Even level of inner and outer corners"\n    ],\n    "attractiveness_score": 50,\n    "score_explanation": "Neutral canthal tilt is generally balanced but does not confer the inherent lift and attractiveness associated with a positive tilt."\n  },\n  "eye_type": {\n    "type": "Prey Eyes",\n    "thought_process": "The eyes appear larger and rounder, creating a gentle and approachable look, indicating prey eyes.",\n    "characteristics_identified": [\n      "Larger and rounder eyes",\n      "More open appearance"\n    ],\n    "attractiveness_score": 40,\n    "score_explanation": "Prey eyes tend to be associated with a gentler and less intense look compared to hunter eyes, which are generally considered more attractive."\n  },\n  "eye_shape": {\n    "type": "Round Eyes",\n    "thought_process": "The eyes have a circular shape with visible whites around the iris, indicating round eyes.",\n    "characteristics_identified": [\n      "Wide-open appearance",\n      "Whites of the eyes visible around the iris"\n    ],\n    "canthal_tilt": "Neutral",\n    "attractiveness_score": 40,\n    "score_explanation": "Round eyes can convey expressiveness and youthfulness but are not typically rated as highly as almond or hunter eyes in terms of attractiveness."\n  },\n  "face_shape": {\n    "type": "Rectangle Face",\n    "thought_process": "The elongated face with straight cheek lines and a defined jawline suggests a rectangular face shape.",\n    "characteristics_identified": [\n      "Longer face",\n      "Straight cheek lines",\n      "Defined jawline"\n    ],\n    "attractiveness_score": 55,\n    "score_explanation": "Rectangle face shapes are fairly common and can be attractive, but might lack the symmetry and balance considered ideal in oval face shapes."\n  },\n  "jawline": {\n    "type": "Strong Jawline",\n    "thought_process": "The angular and well-defined nature of the jawline suggests a strong jawline.",\n    "characteristics_identified": [\n      "Prominent and angular jaw",\n      "Clear distinction between the jaw and neck"\n    ],\n    "attractiveness_score": 80,\n    "score_explanation": "A strong jawline is commonly associated with attractiveness and masculinity, contributing positively to the overall facial structure."\n  },\n  "cheekbones": {\n    "type": "High Cheekbones",\n    "thought_process": "The prominence and elevated position of the cheekbones suggest high cheekbones.",\n    "characteristics_identified": [\n      "Prominent and elevated cheekbones",\n      "Well-defined facial structure"\n    ],\n    "attractiveness_score": 70,\n    "score_explanation": "High cheekbones are often considered an attractive trait and contribute to a well-defined and appealing facial structure."\n  },\n  "masculinity_femininity": {\n    "type": "Masculine Features",\n    "thought_process": "Features such as a strong jawline and prominent brow ridge denote masculine attributes.",\n    "characteristics_identified": [\n      "Strong jawline",\n      "Prominent brow ridge",\n      "Broader forehead"\n    ],\n    "attractiveness_score": 75,\n    "score_explanation": "Masculine features like a strong jawline and brow ridge are generally associated with attractiveness and confer a strong, defined look."\n  },\n  "skin_quality": {\n    "type": "Clear Skin",\n    "thought_process": "The skin appears smooth with minimal visible blemishes, though there is some slight redness and a few minor imperfections.",\n    "characteristics_identified": [\n      "Smooth texture",\n      "Even skin tone",\n      "Minimal visible blemishes"\n    ],\n    "attractiveness_score": 70,\n    "score_explanation": "Clear skin is a positive attribute, though minor imperfections slightly reduce the score."\n  },\n  "hair_attractiveness": {\n    "type": "Slightly Above Average",\n    "thought_process": "The hair appears well-groomed with good texture, though it lacks the thick and lush volume of the highest ratings.",\n    "characteristics_identified": [\n      "Well-groomed",\n      "Good texture"\n    ],\n    "attractiveness_score": 60,\n    "score_explanation": "The hair is well-kept and has a good aesthetic but is not exceptionally thick or lush."\n  }\n  "potential": {\n    "type": "Moderate Potential",\n    "thought_process": "With clear skin, a strong jawline, and high cheekbones, the person has a good base to improve with further grooming and skincare.",\n    "characteristics_identified": [\n      "High cheekbones",\n      "Strong jawline",\n      "Clear skin"\n    ],\n    "attractiveness_score": 65,\n    "explanation": "The individual has a solid foundation with features that can be further enhanced through grooming, skincare, and styling techniques to achieve a more attractive appearance."\n  }\n}',
          },
        ],
      },
      {
        role: "user",
        content: [
          {
            type: "image_url",
            image_url: {
              url: imageUrl,
            },
          },
        ],
      },
    ],
    temperature: 1,
    max_tokens: 1724,
    top_p: 1,
    frequency_penalty: 0,
    presence_penalty: 0,
  });

  const suggestions = response.choices[0].message?.content;

  return suggestions;
};
